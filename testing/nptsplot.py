import meep as mp	
import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
import math as math			

#time: 5 dpml: 0.5 res: 40 offset: 0 r; 20
#symmetry=[mp.Mirror(mp.X),mp.Mirror(mp.Y,phase=-1),mp.Mirror(mp.Z)]
NPTS=[30,60,90,120,150,200,250,300,400,450,600,700,800,900,1000,1200,1400,2000,3000]
farfieldflux=[0.44217483,0.43487465,0.43771086,0.43951345,0.4367545,0.43798811,0.43888323,0.43973498,0.43889659,0.43792807,
0.43707977,0.43795148,0.4385902,0.43843797,0.43762474,0.43794102,0.43830161,0.43786075,0.43794555]
time=[2.5,5,10,20,40]
total_flux=[0.7600748646240835,1.325014335273617,1.3251745134242714,1.3251602765723127,1.3251661436561768]

#time: 5 dpml: 0.5
total_flux=[1.2896091139499157,1.3203689503454936,1.325014335273617,1.3242840037511816,1.3249920087996594,1.3252489988563414]
res=[10,20,40,80,120,160]
plt.title('flux vs res time:5')
#plt.plot(res,total_flux)
#plt.show()

#time:5 dpml: 0.5 res: 80 r:20 flux vs npts
total_flux=[0.63580136, 0.62073483,0.62733091,0.62863217,0.62745988,0.62625614,0.62664326]
npts=[30, 100, 200, 400, 800, 1600, 3200]
plt.title('flux vs npts')
#plt.plot(npts,total_flux)
#plt.show()

#simulation_time: 15 dpml: 0.1 r: 300 npts: 1600
resolution=[10,20,40,60,80,120,140]
ratio=[0.16217052,0.04564019,0.03975171,0.04212829,0.04469922,0.04801199,0.04970425]

#plt.plot(resolution,ratio)
#plt.show()

#simulation_time: 15 dpml: 0.1 res: 80 r: 300 npts: 1600
ratio1=[0.09293663,0.08623791,0.07368357,0.05826243,0.0499003,0.06165087,0.04257138,0.03975171,0.03062496,0.05413541,0.04335422,0.04463254,0.03309853] # res40
ff1=[0.11430567,0.07049791,0.03379285,0.05798999,0.08259489,0.1215488,0.13556745,0.13915352,0.12398515,0.12115092,0.13085273,0.14142186,0.12653442]
ratio2=[0.10915856,0.10949028,0.10704167,0.07626584,0.05839239,0.0698145,0.04800721,0.04212829,0.0314953,0.05448888,0.04850268,0.05059165,0.03490777] #res60
ff2=[0.12663718,0.03028357,0.0402409,0.0611012,0.08919964,0.13908155,0.15475778,0.14549792,0.12991686,0.12584487,0.14890548,0.15707265,0.13513508]
ratio3=[0.12115113,0.14638241,0.13083482,0.08723537,0.06515418,0.07657071,0.05082643,0.04469922,0.03300272,0.05675526,0.05222063,0.05392027,.03666003] #res80
ff3=[0.13560147,0.02609257,0.04613723,0.07285158,0.10397151,0.15109467,0.16553987,0.15326343,0.13277171,0.13124342,0.16065732,0.16926118,0.14269187]
ratio4=[0.14055834,0.20569364,0.1679512,0.10858052,0.07870621,0.0852075,0.05632203,0.04801199,0.03569256,0.06172507,0.05850669,0.05966408,0.03958694] #res120
ff4=[0.1511039,0.03485354,0.06040833,0.09153319,0.12219786,0.170601,0.18392262,0.16826176,0.14397012,0.14355228,0.17814082,0.18627938,0.15479655]
source_pos=[0.00,0.01,0.02,0.03,0.04,0.06,0.08,0.1,0.12,0.14,0.16,0.18,0.20]
plt.title('res vs ratio')
plt.plot(source_pos,ratio1,'-b',label='res40')
plt.plot(source_pos,ratio2,'-r',label='res60')
plt.plot(source_pos,ratio3,'-g',label='res80')
plt.plot(source_pos,ratio4,'-y',label='res120')
plt.legend(loc='best')
plt.show()
